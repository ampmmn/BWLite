# Soyokaze

bluewind風のランチャーソフト。

![画面](image/soyokaze-window.gif)

## bluewindとは

bluewindのReadMeから抜粋
```
初心者から上級者まで幅広く使えるコマンドラインランチャーです。
簡単なキーワードをファイルやURLに関連付け、
キーボードからそのキーワードを打ち込むことで
アプリケーションを起動させたり、Webサイトを開いたりできます。
```

個人的にとても気に入って長年使ってきたツールで、
今でも普通に使えるけど、一次配布元サイトが消滅(&更新停止)して久しい。

## 動作環境

下記環境での動作を確認済

- Windows 11(64bit)
- Windows 10(64bit)

## インストール手順

1. zipをファイルを展開して任意のフォルダに展開する
1. 展開先フォルダにある`soyokaze.exe`を実行する
1. 設定はユーザフォルダ(たいていは C:/Users/(ユーザ名))直下の`.soyokaze`フォルダに保存される  
初回実行時に`.soyokaze`フォルダを作成する
  * レジストリを一切変更しない

## アンインストール手順

アンインストーラはないため、以下すべてを手動で行う。

1. アプリケーションの設定-ショートカット設定を表示し、すべてのショートカットを削除する
1. `soyokaze.exe`を終了する
1. インストール時に`soyokaze.exe`を置いたフォルダごと削除する
1. 設定フォルダ(C:/Users/(ユーザ名)/.soyokaze)を削除する

## ファイル構成

- soyokaze.exe
- help.html
- LICENSE

## 主な特徴

- ホットキーでウインドウの呼び出しができる。初期値はAlt-Space
- 任意のファイルやフォルダを登録してキーワードで呼び出すことができる
- 登録したキーワード(コマンド)に対してショートカットキーを設定することができる
- レジストリをいじらない
- ファイル名やURLを直接指定しての実行が可能
- パラメータにキーワードを使用することができる

## 最初から入っているキーワード

- new
  - 新規コマンド登録画面を表示する
- edit
  - 既存コマンド編集画面を表示する
- emptyrecyclebin
  - ごみ箱を空にする
- manager
  - キーワードマネージャ画面を表示する
- setting
  - アプリケーション設定画面を表示する
- exit
  - アプリケーションを終了する
- registwin
  - 直前にアクティブなウインドウをコマンドとして登録する
- maindir
  - アプリの実行ファイルがあるフォルダを表示する
- userdir
  - 設定ファイルの保存先フォルダ(C:/Users/(ユーザ名)/.soyokaze)を表示する
- reload
  - 設定ファイルの再読み込みを行う  
(テキストエディタで直接キーワード編集を行ったときにリロードするためもの)
- cd
  - カレントディレクトリを変更する
- delete
  - コマンドを削除する
- version
  - バージョン情報ダイアログを表示する
- newsnippet
  - 現在クリップボードにあるテキストを定型文として登録するための登録画面を表示する
- logoff
  - ログオフする
- shutdown
  - PCをシャットダウンする
- reboot
  - PCを再起動する
- standby
  - PCをスタンバイ状態にする
- suspend
  - PCをサスペンド状態にする
- lockscreen
  - スクリーンロックする


## ライセンス

[MIT License](./LICENSE)


## 実行時に必要なライブラリ

- [Python3](https://www.python.org/) (任意)
  - 電卓機能を利用するために必要
  - なくても電卓機能が使えないだけで、アプリ自体は使える。

- [C/Migemo](https://www.kaoriya.net/software/cmigemo/) (任意)
  - ローマ字による日本語文字列検索を利用するために必要
    - 例えば、`jikoku`で`時刻`や`自国`にヒットするようになる
  - なくても、アプリ自体は使える。

## 画面など

画面のつくりはbluewindにある程度似せて作っている

### 入力画面

![](image/soyokaze-window.png)

### キーワードマネージャ

![](image/keywordmanager.png)

### コマンド登録・編集画面

![](image/edit.png)

### 設定画面

![](image/setting.png)

![](image/shortcut_setting.png)

## ビルド

### 開発環境

- VisualStudio2022
- C++のプロジェクト
- MFCを使っている

ユニットテストフレームワークとしてgoogletest(1.13.0)を用いている。

### ビルド時に必要な外部ライブラリ

- [nlohmann-json](https://github.com/nlohmann/json)
  - JSONを読むために利用している。  
ヘッダファイルベースのライブラリなので、このライブラリをビルドする必要はなく、配置するだけでよい。

### nlohmann-jsonの配置

- https://github.com/nlohmann/json からソース一式を取得する
- `Soyokaze`のソースファイル一式と同じ階層に`nlohmann-json`を配置する

- `Soyokaze`のプロジェクト設定にて、`Soyokaze.sln`と同じ階層に`json`というフォルダがあることを想定している  
以下のように置く  
↓
```
soyokaze-src/
  Soyokaze.sln
  json/
    include/
      nlohmann/
        json.hpp
```

### ビルド方法

- VisualStudioでソリューションファイル`Soyokaze.sln`を開く
  - メニューの `ファイル`→`開く`→`プロジェクト/ソリューション`

- プロジェクト設定の下記項目を変更する必要があるのでビルド環境にあわせて設定する
  - `構成プロパティ`→`全般`→`Windows SDKバージョン`
  - `構成プロパティ`→`全般`→`プラットフォームツールセット`

- ビルドを実行する
  - メニューの `ビルド`→`ソリューションのビルド`

- ビルドが完了すると下記の場所にモジュールがてきる
  - `x64`/(`Debug` or `Release` or `ReleaseStatic`)
    - 64bit版モジュールの場合

### ソリューション構成について

- Debug → デバッグ情報あり
- Release → デバッグ情報なし、最適化してる、共有DLLでMFCを使う
- ReleaseStatic → デバッグ情報なし、最適化してる、スタティックライブラリでMFCを使う。
- Release-Portable→ デバッグ情報なし、最適化してる、スタティックライブラリでMFCを使う。設定情報を`soyokaze.exe`と同じフォルダ以下に保存する
- ReleaseStatic-Portable → デバッグ情報なし、最適化してる、スタティックライブラリでMFCを使う。設定情報を`soyokaze.exe`と同じフォルダ以下に保存する
- UnitTest → ユニットテストのビルド用
  - 本体のexe(soyokaze.exe)を.libとしてビルドし、ユニットテスト側の.exeにリンクする構成

### キーワード絞込みの仕様

- 指定したキーワードが候補の名前に部分一致するかどうかで判断を行う
- スペース区切りで複数キーワード指定された場合、個々のキーワードごとに候補の名前と部分一致比較を行い、すべてマッチするものを対象とする
- 候補の表示優先順位は 完全一致が最も優先、次に前方一致、最後に部分一致 の順
  - キーワードのいずれかが、候補と完全一致する場合、完全一致とみなす
  - 先頭のキーワードと候補が前方一致する場合、前方一致とみなす
  - 与えられたキーワードが候補に部分的に一致する場合、部分一致とみなす
- ダブルクォーテーションで囲った場合はキーワードに空白を含めることができる
- 複数のキーワードが与えられた場合に先頭キーワードと候補が完全一致する場合、後続のキーワードをパラメータ指定とみなす

## ToDo

- 設計資料を残す
- ユニットテスト拡充

## ChangeLog

[CHANGELOG.md](./CHANGELOG.md)

